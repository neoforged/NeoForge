--- a/net/minecraft/world/inventory/MenuType.java
+++ b/net/minecraft/world/inventory/MenuType.java
@@ -8,7 +_,7 @@
 import net.minecraft.world.flag.FeatureFlagSet;
 import net.minecraft.world.flag.FeatureFlags;
 
-public class MenuType<T extends AbstractContainerMenu> implements FeatureElement {
+public class MenuType<T extends AbstractContainerMenu> implements FeatureElement, net.neoforged.neoforge.common.extensions.IMenuTypeExtension<T> {
     public static final MenuType<ChestMenu> GENERIC_9x1 = register("generic_9x1", ChestMenu::oneRow);
     public static final MenuType<ChestMenu> GENERIC_9x2 = register("generic_9x2", ChestMenu::twoRows);
     public static final MenuType<ChestMenu> GENERIC_9x3 = register("generic_9x3", ChestMenu::threeRows);
@@ -36,18 +_,20 @@
     public static final MenuType<StonecutterMenu> STONECUTTER = register("stonecutter", StonecutterMenu::new);
     private final FeatureFlagSet requiredFeatures;
     private final MenuType.MenuSupplier<T> constructor;
+    private final java.util.Set<net.neoforged.neoforge.flag.Flag> requiredFlags;
 
     private static <T extends AbstractContainerMenu> MenuType<T> register(String p_39989_, MenuType.MenuSupplier<T> p_39990_) {
-        return Registry.register(BuiltInRegistries.MENU, p_39989_, new MenuType<>(p_39990_, FeatureFlags.VANILLA_SET));
+        return Registry.register(BuiltInRegistries.MENU, p_39989_, new MenuType<>(p_39990_, FeatureFlags.VANILLA_SET, java.util.Collections.emptySet()));
     }
 
     private static <T extends AbstractContainerMenu> MenuType<T> register(String p_267295_, MenuType.MenuSupplier<T> p_266945_, FeatureFlag... p_267055_) {
-        return Registry.register(BuiltInRegistries.MENU, p_267295_, new MenuType<>(p_266945_, FeatureFlags.REGISTRY.subset(p_267055_)));
+        return Registry.register(BuiltInRegistries.MENU, p_267295_, new MenuType<>(p_266945_, FeatureFlags.REGISTRY.subset(p_267055_), java.util.Collections.emptySet()));
     }
 
-    public MenuType(MenuType.MenuSupplier<T> p_267054_, FeatureFlagSet p_266909_) {
+    public MenuType(MenuType.MenuSupplier<T> p_267054_, FeatureFlagSet p_266909_, java.util.Set<net.neoforged.neoforge.flag.Flag> requiredFlags) {
         this.constructor = p_267054_;
         this.requiredFeatures = p_266909_;
+        this.requiredFlags = java.util.Set.copyOf(requiredFlags);
     }
 
     public T create(int p_39986_, Inventory p_39987_) {
@@ -55,8 +_,21 @@
     }
 
     @Override
+    public T create(int windowId, Inventory playerInv, net.minecraft.network.RegistryFriendlyByteBuf extraData) {
+        if (this.constructor instanceof net.neoforged.neoforge.network.IContainerFactory) {
+            return ((net.neoforged.neoforge.network.IContainerFactory<T>) this.constructor).create(windowId, playerInv, extraData);
+        }
+        return create(windowId, playerInv);
+    }
+
+    @Override
     public FeatureFlagSet requiredFeatures() {
         return this.requiredFeatures;
+    }
+
+    @Override
+    public final java.util.Set<net.neoforged.neoforge.flag.Flag> requiredFlags() {
+        return requiredFlags;
     }
 
     public interface MenuSupplier<T extends AbstractContainerMenu> {
